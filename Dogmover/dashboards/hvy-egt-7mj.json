{
    "author_handle": "scott@joinhandshake.com",
    "author_name": "Scott Ringwelski",
    "created_at": "2022-07-26T16:38:40.793559+00:00",
    "description": "",
    "id": "hvy-egt-7mj",
    "is_read_only": false,
    "layout_type": "ordered",
    "modified_at": "2022-07-27T20:56:05.111709+00:00",
    "notify_list": [],
    "reflow_type": "fixed",
    "restricted_roles": [],
    "template_variables": [],
    "title": "Notifications Purge BTS 2022",
    "url": "/dashboard/hvy-egt-7mj/notifications-purge-bts-2022",
    "widgets": [
        {
            "definition": {
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "legend_layout": "auto",
                "requests": [
                    {
                        "display_type": "line",
                        "formulas": [
                            {
                                "formula": "query1"
                            },
                            {
                                "formula": "query2"
                            }
                        ],
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "query1",
                                "query": "max:postgresql.live_rows{table:notifications,cluster-name:production}"
                            },
                            {
                                "data_source": "metrics",
                                "name": "query2",
                                "query": "max:postgresql.dead_rows{table:notifications,cluster-name:production}"
                            }
                        ],
                        "response_format": "timeseries",
                        "style": {
                            "line_type": "solid",
                            "line_width": "normal",
                            "palette": "dog_classic"
                        }
                    }
                ],
                "show_legend": true,
                "title": "notifications live / dead rows",
                "title_align": "left",
                "title_size": "16",
                "type": "timeseries"
            },
            "id": 1710389708184166,
            "layout": {
                "height": 2,
                "width": 4,
                "x": 0,
                "y": 0
            }
        },
        {
            "definition": {
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "legend_layout": "auto",
                "requests": [
                    {
                        "display_type": "line",
                        "formulas": [
                            {
                                "formula": "query1"
                            }
                        ],
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "query1",
                                "query": "avg:postgresql.rows_deleted{cluster-name:production,table:notifications}"
                            }
                        ],
                        "response_format": "timeseries",
                        "style": {
                            "line_type": "solid",
                            "line_width": "normal",
                            "palette": "dog_classic"
                        }
                    }
                ],
                "show_legend": true,
                "title": "notifications deletion rate",
                "title_align": "left",
                "title_size": "16",
                "type": "timeseries"
            },
            "id": 6306648037926622,
            "layout": {
                "height": 2,
                "width": 4,
                "x": 4,
                "y": 0
            }
        },
        {
            "definition": {
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "legend_layout": "auto",
                "markers": [
                    {
                        "display_type": "info dashed",
                        "label": "Aug 1 Target Avg",
                        "value": "y = 10"
                    },
                    {
                        "display_type": "warning dashed",
                        "label": "Aug 1 Target Max",
                        "value": "y = 20"
                    }
                ],
                "requests": [
                    {
                        "display_type": "area",
                        "formulas": [
                            {
                                "alias": "IO Wait Seconds",
                                "formula": "per_second(query2) / 1000000"
                            },
                            {
                                "alias": "CPU and CPU Wait Seconds",
                                "formula": "(per_second(query1) / 1000000) - (per_second(query2) / 1000000) - (per_second(query3) / 1000000)"
                            },
                            {
                                "alias": "Lock Wait Seconds",
                                "formula": "per_second(query3) / 1000000"
                            }
                        ],
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "query2",
                                "query": "sum:gcp.cloudsql.database.postgresql.insights.aggregate.io_time{database:handshake,location:us-central,resource_id:handshake-production:handshake-brave-mayfly}"
                            },
                            {
                                "data_source": "metrics",
                                "name": "query1",
                                "query": "sum:gcp.cloudsql.database.postgresql.insights.aggregate.execution_time{database:handshake,location:us-central,resource_id:handshake-production:handshake-brave-mayfly}"
                            },
                            {
                                "data_source": "metrics",
                                "name": "query3",
                                "query": "sum:gcp.cloudsql.database.postgresql.insights.aggregate.lock_time{database:handshake,location:us-central,resource_id:handshake-production:handshake-brave-mayfly}"
                            }
                        ],
                        "response_format": "timeseries",
                        "style": {
                            "line_type": "solid",
                            "line_width": "normal",
                            "palette": "dog_classic"
                        }
                    }
                ],
                "show_legend": true,
                "title": "Monolith Database CPU-Seconds",
                "title_align": "left",
                "title_size": "16",
                "type": "timeseries"
            },
            "id": 2725865700216282,
            "layout": {
                "height": 2,
                "width": 4,
                "x": 8,
                "y": 0
            }
        },
        {
            "definition": {
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "legend_layout": "auto",
                "requests": [
                    {
                        "display_type": "line",
                        "formulas": [
                            {
                                "formula": "query1"
                            }
                        ],
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "query1",
                                "query": "avg:gcp.cloudsql.database.cpu.utilization{database_id:handshake-production:handshake-brave-mayfly}"
                            }
                        ],
                        "response_format": "timeseries",
                        "style": {
                            "line_type": "solid",
                            "line_width": "normal",
                            "palette": "dog_classic"
                        }
                    }
                ],
                "show_legend": true,
                "title": "Brave Mayfly CPU usage",
                "title_align": "left",
                "title_size": "16",
                "type": "timeseries"
            },
            "id": 3966897265396560,
            "layout": {
                "height": 2,
                "width": 4,
                "x": 0,
                "y": 2
            }
        },
        {
            "definition": {
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "legend_layout": "auto",
                "requests": [
                    {
                        "display_type": "line",
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "p50",
                                "query": "p50:trace.postgres.query{env:production,region:us-central1,resource:2631dbe0c774897a,service:handshake-postgres}"
                            }
                        ],
                        "response_format": "timeseries"
                    },
                    {
                        "display_type": "line",
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "p75",
                                "query": "p75:trace.postgres.query{env:production,region:us-central1,resource:2631dbe0c774897a,service:handshake-postgres}"
                            }
                        ],
                        "response_format": "timeseries"
                    },
                    {
                        "display_type": "line",
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "p90",
                                "query": "p90:trace.postgres.query{env:production,region:us-central1,resource:2631dbe0c774897a,service:handshake-postgres}"
                            }
                        ],
                        "response_format": "timeseries"
                    },
                    {
                        "display_type": "line",
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "p95",
                                "query": "p95:trace.postgres.query{env:production,region:us-central1,resource:2631dbe0c774897a,service:handshake-postgres}"
                            }
                        ],
                        "response_format": "timeseries"
                    },
                    {
                        "display_type": "line",
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "p99",
                                "query": "p99:trace.postgres.query{env:production,region:us-central1,resource:2631dbe0c774897a,service:handshake-postgres}"
                            }
                        ],
                        "response_format": "timeseries"
                    },
                    {
                        "display_type": "line",
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "max",
                                "query": "max:trace.postgres.query{env:production,region:us-central1,resource:2631dbe0c774897a,service:handshake-postgres}"
                            }
                        ],
                        "response_format": "timeseries"
                    }
                ],
                "show_legend": false,
                "title": "Postgres query notifications count latency",
                "title_align": "left",
                "title_size": "16",
                "type": "timeseries"
            },
            "id": 5579964950886980,
            "layout": {
                "height": 2,
                "width": 4,
                "x": 4,
                "y": 2
            }
        },
        {
            "definition": {
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "legend_layout": "auto",
                "requests": [
                    {
                        "display_type": "line",
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "p50",
                                "query": "p50:trace.rack.request{env:production,region:us-central1,resource:8687267bb90b08c1,service:handshake}"
                            }
                        ],
                        "response_format": "timeseries"
                    },
                    {
                        "display_type": "line",
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "p75",
                                "query": "p75:trace.rack.request{env:production,region:us-central1,resource:8687267bb90b08c1,service:handshake}"
                            }
                        ],
                        "response_format": "timeseries"
                    },
                    {
                        "display_type": "line",
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "p90",
                                "query": "p90:trace.rack.request{env:production,region:us-central1,resource:8687267bb90b08c1,service:handshake}"
                            }
                        ],
                        "response_format": "timeseries"
                    },
                    {
                        "display_type": "line",
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "p95",
                                "query": "p95:trace.rack.request{env:production,region:us-central1,resource:8687267bb90b08c1,service:handshake}"
                            }
                        ],
                        "response_format": "timeseries"
                    },
                    {
                        "display_type": "line",
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "p99",
                                "query": "p99:trace.rack.request{env:production,region:us-central1,resource:8687267bb90b08c1,service:handshake}"
                            }
                        ],
                        "response_format": "timeseries"
                    },
                    {
                        "display_type": "line",
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "max",
                                "query": "max:trace.rack.request{env:production,region:us-central1,resource:8687267bb90b08c1,service:handshake}"
                            }
                        ],
                        "response_format": "timeseries"
                    }
                ],
                "show_legend": false,
                "title": "Next::Student::NotificationCountsController latencies",
                "title_align": "left",
                "title_size": "16",
                "type": "timeseries"
            },
            "id": 5854801495315026,
            "layout": {
                "height": 2,
                "width": 4,
                "x": 8,
                "y": 2
            }
        },
        {
            "definition": {
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "legend_layout": "auto",
                "requests": [
                    {
                        "display_type": "bars",
                        "formulas": [
                            {
                                "formula": "query1"
                            }
                        ],
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "query1",
                                "query": "sum:trace.rails.action_controller.errors{env:production,region:us-central1,service:handshake,resource_name:next::student::notificationcountscontroller_topbar_updates} by {http.status_code}.as_count()"
                            }
                        ],
                        "response_format": "timeseries",
                        "style": {
                            "palette": "warm"
                        }
                    },
                    {
                        "display_type": "line",
                        "formulas": [
                            {
                                "formula": "query0"
                            }
                        ],
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "query0",
                                "query": "sum:trace.rails.action_controller.hits{env:production,region:us-central1,service:handshake,resource_name:next::student::notificationcountscontroller_topbar_updates}.as_count()"
                            }
                        ],
                        "response_format": "timeseries",
                        "style": {
                            "line_type": "solid",
                            "line_width": "normal",
                            "palette": "dog_classic"
                        }
                    }
                ],
                "show_legend": false,
                "time": {},
                "title": "Student Notification Count endpoint hit/error rate",
                "title_align": "left",
                "title_size": "16",
                "type": "timeseries"
            },
            "id": 6155427594105284,
            "layout": {
                "height": 2,
                "width": 4,
                "x": 0,
                "y": 4
            }
        },
        {
            "definition": {
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "legend_layout": "auto",
                "requests": [
                    {
                        "display_type": "bars",
                        "formulas": [
                            {
                                "formula": "query1"
                            }
                        ],
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "query1",
                                "query": "sum:postgresql.autovacuumed{db:handshake,project:handshake-production,table:notifications} by {table}.as_count()"
                            }
                        ],
                        "response_format": "timeseries",
                        "style": {
                            "line_type": "solid",
                            "line_width": "normal",
                            "palette": "dog_classic"
                        }
                    }
                ],
                "show_legend": true,
                "title": "notifications autovacuums",
                "title_align": "left",
                "title_size": "16",
                "type": "timeseries"
            },
            "id": 8009750427013986,
            "layout": {
                "height": 2,
                "width": 4,
                "x": 4,
                "y": 4
            }
        },
        {
            "definition": {
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "legend_layout": "auto",
                "requests": [
                    {
                        "display_type": "bars",
                        "formulas": [
                            {
                                "formula": "query1"
                            }
                        ],
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "query1",
                                "query": "sum:postgresql.analyzed{table:notifications,cluster-name:production}.as_count()"
                            }
                        ],
                        "response_format": "timeseries",
                        "style": {
                            "line_type": "solid",
                            "line_width": "normal",
                            "palette": "dog_classic"
                        }
                    }
                ],
                "show_legend": true,
                "title": "notifications table analyzed",
                "title_align": "left",
                "title_size": "16",
                "type": "timeseries"
            },
            "id": 2079133107116898,
            "layout": {
                "height": 2,
                "width": 4,
                "x": 8,
                "y": 4
            }
        },
        {
            "definition": {
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "legend_layout": "auto",
                "requests": [
                    {
                        "display_type": "bars",
                        "formulas": [
                            {
                                "formula": "query1"
                            }
                        ],
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "query1",
                                "query": "sum:postgresql.vacuumed{table:notifications,cluster-name:production}.as_count()"
                            }
                        ],
                        "response_format": "timeseries",
                        "style": {
                            "line_type": "solid",
                            "line_width": "normal",
                            "palette": "dog_classic"
                        }
                    }
                ],
                "show_legend": true,
                "title": "notifications all vacuums",
                "title_align": "left",
                "title_size": "16",
                "type": "timeseries"
            },
            "id": 4079618187650688,
            "layout": {
                "height": 2,
                "width": 4,
                "x": 0,
                "y": 6
            }
        },
        {
            "definition": {
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "legend_layout": "auto",
                "requests": [
                    {
                        "display_type": "line",
                        "formulas": [
                            {
                                "formula": "query1"
                            }
                        ],
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "query1",
                                "query": "max:postgresql.table_size{table:notifications,cluster-name:production}"
                            }
                        ],
                        "response_format": "timeseries",
                        "style": {
                            "line_type": "solid",
                            "line_width": "normal",
                            "palette": "dog_classic"
                        }
                    }
                ],
                "show_legend": true,
                "title": "notifications table size",
                "title_align": "left",
                "title_size": "16",
                "type": "timeseries"
            },
            "id": 879238354409230,
            "layout": {
                "height": 2,
                "width": 4,
                "x": 4,
                "y": 6
            }
        },
        {
            "definition": {
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "legend_layout": "auto",
                "requests": [
                    {
                        "display_type": "line",
                        "formulas": [
                            {
                                "formula": "query1"
                            }
                        ],
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "query1",
                                "query": "max:postgresql.index_size{table:notifications,cluster-name:production}"
                            }
                        ],
                        "response_format": "timeseries",
                        "style": {
                            "line_type": "solid",
                            "line_width": "normal",
                            "palette": "dog_classic"
                        }
                    }
                ],
                "show_legend": true,
                "title": "notifications index size",
                "title_align": "left",
                "title_size": "16",
                "type": "timeseries"
            },
            "id": 8179119027809316,
            "layout": {
                "height": 2,
                "width": 4,
                "x": 8,
                "y": 6
            }
        },
        {
            "definition": {
                "legend_columns": [
                    "avg",
                    "min",
                    "max",
                    "value",
                    "sum"
                ],
                "legend_layout": "auto",
                "requests": [
                    {
                        "display_type": "line",
                        "formulas": [
                            {
                                "formula": "query1"
                            }
                        ],
                        "queries": [
                            {
                                "data_source": "metrics",
                                "name": "query1",
                                "query": "max:postgresql.database_size{cluster-name:production,instance_name:handshake-brave-mayfly}"
                            }
                        ],
                        "response_format": "timeseries",
                        "style": {
                            "line_type": "solid",
                            "line_width": "normal",
                            "palette": "dog_classic"
                        }
                    }
                ],
                "show_legend": true,
                "title": "Total DB size",
                "title_align": "left",
                "title_size": "16",
                "type": "timeseries"
            },
            "id": 7527018976429436,
            "layout": {
                "height": 2,
                "width": 4,
                "x": 0,
                "y": 8
            }
        }
    ]
}