{
    "author_handle": "scott@joinhandshake.com",
    "author_name": "Scott Ringwelski",
    "created_at": "2019-05-20T23:51:09.607255+00:00",
    "description": "",
    "id": "9ih-fed-msz",
    "is_read_only": false,
    "layout_type": "ordered",
    "modified_at": "2020-06-08T23:20:27.877376+00:00",
    "notify_list": [],
    "restricted_roles": [],
    "template_variables": [
        {
            "default": "*",
            "name": "env",
            "prefix": "env"
        },
        {
            "default": "us-central1",
            "name": "region",
            "prefix": "region"
        }
    ],
    "title": "[Elasticsearch] Cluster Targets by User Type",
    "url": "/dashboard/9ih-fed-msz/elasticsearch-cluster-targets-by-user-type",
    "widgets": [
        {
            "definition": {
                "layout_type": "ordered",
                "title": "Legacy Cluster Usage Breakdown",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,es_cluster:default,$region} by {user_type,index}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "time": {},
                            "title": "All Legacy Index Usage",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 889015560122540
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,es_cluster:default,index:searchindices::postings,$region} by {user_type}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Legacy Postings Index Usage",
                            "type": "timeseries"
                        },
                        "id": 3671230150295620
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,es_cluster:default,index:searchindices::employerapprovals,$region} by {user_type}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Legacy Employer Approvals Index Usage",
                            "type": "timeseries"
                        },
                        "id": 4654604717609450
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,es_cluster:default,index:searchindices::applications,$region} by {user_type}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Legacy Applications Index Usage",
                            "type": "timeseries"
                        },
                        "id": 2342059491037804
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,es_cluster:default,index:searchindices::users,$region} by {user_type}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Legacy Users Index Usage",
                            "type": "timeseries"
                        },
                        "id": 4688726282703112
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,es_cluster:default,index:searchindices::schools,$region} by {user_type}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Legacy Schools Index Usage",
                            "type": "timeseries"
                        },
                        "id": 790501223061810
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,es_cluster:default,index:searchindices::events,$region} by {user_type}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Legacy Events Index Usage",
                            "type": "timeseries"
                        },
                        "id": 2860374800348928
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,es_cluster:default,index:searchindices::employers,$region} by {user_type}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Legacy Employers Index Usage",
                            "type": "timeseries"
                        },
                        "id": 8154469624758016
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,es_cluster:default,index:searchindices::jobs,$region} by {user_type}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Legacy Jobs Index Usage",
                            "type": "timeseries"
                        },
                        "id": 696310706927356
                    }
                ]
            },
            "id": 6852357868117484
        },
        {
            "definition": {
                "layout_type": "ordered",
                "title": "Legacy Cluster Breakdown - Scrolling",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.scroll_destinations.count{$env,es_cluster:default,index:searchindices::postings,$region} by {user_type}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Legacy Postings Index Usage",
                            "type": "timeseries"
                        },
                        "id": 8106137938805514
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.scroll_destinations.count{$env,es_cluster:default,index:searchindices::users,$region} by {user_type}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Legacy Users Index Usage",
                            "type": "timeseries"
                        },
                        "id": 8586004888915084
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.scroll_destinations.count{$env,es_cluster:default,index:searchindices::applications,$region} by {user_type}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Legacy Applications Index Usage",
                            "type": "timeseries"
                        },
                        "id": 4387553348785802
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.scroll_destinations.count{$env,es_cluster:default,index:searchindices::employerapprovals,$region} by {user_type}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Legacy Employer Approvals Index Usage",
                            "type": "timeseries"
                        },
                        "id": 7293917191555588
                    }
                ]
            },
            "id": 4757573405537554
        },
        {
            "definition": {
                "layout_type": "ordered",
                "title": "Student users",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,es_cluster:students,user_type:students,$region} by {index}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Students to Student Cluster - Search",
                            "type": "timeseries"
                        },
                        "id": 599014592110432
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.scroll_destinations.count{$env,es_cluster:students,user_type:students,$region} by {index}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Students to Student Cluster - Scroll",
                            "type": "timeseries"
                        },
                        "id": 5260802181214768
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,es_cluster:default,user_type:students,$region} by {index}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Students to Legacy Cluster",
                            "type": "timeseries"
                        },
                        "id": 2703855744413108
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.scroll_destinations.count{$env,es_cluster:default,user_type:students,$region} by {index}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Students to Legacy Cluster - Scroll",
                            "type": "timeseries"
                        },
                        "id": 2046689656794102
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "q": "top(sum:es.query_destinations.count{$env,es_cluster:default,user_type:students,$region} by {index}.as_count(), 5, 'sum', 'desc')",
                                    "style": {
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "title": "Students to Legacy Cluster",
                            "type": "toplist"
                        },
                        "id": 8326199173656764
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "q": "autosmooth(sum:es.query_destinations.count{env:production,user_type:students,es_cluster:students,$region}.as_count()/(sum:es.query_destinations.count{env:production,user_type:students,es_cluster:students,$region}.as_count()+sum:es.query_destinations.count{env:production,es_cluster:default,user_type:students,$region}.as_count()))",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                },
                                {
                                    "display_type": "line",
                                    "q": "week_before(autosmooth(sum:es.query_destinations.count{env:production,user_type:students,es_cluster:students,$region}.as_count()/(sum:es.query_destinations.count{env:production,user_type:students,es_cluster:students,$region}.as_count()+sum:es.query_destinations.count{env:production,es_cluster:default,user_type:students,$region}.as_count())))",
                                    "style": {
                                        "line_type": "dotted",
                                        "line_width": "normal",
                                        "palette": "gray"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Students Cluster Percentage",
                            "type": "timeseries"
                        },
                        "id": 5074098608740438
                    }
                ]
            },
            "id": 1060719784222418
        },
        {
            "definition": {
                "layout_type": "ordered",
                "title": "Uni Users",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,es_cluster:universities,user_type:career_services,$region} by {index}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Uni to Uni Cluster",
                            "type": "timeseries"
                        },
                        "id": 811834591856434
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.scroll_destinations.count{$env,es_cluster:universities,user_type:career_services,$region} by {index}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Uni to Uni Cluster - Scrolls",
                            "type": "timeseries"
                        },
                        "id": 5535589511665378
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,user_type:career_services,es_cluster:default,$region} by {index}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Uni to Legacy Cluster",
                            "type": "timeseries"
                        },
                        "id": 2813809182335036
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.scroll_destinations.count{$env,user_type:career_services,es_cluster:default,$region} by {index}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Uni to Legacy Cluster - Scroll",
                            "type": "timeseries"
                        },
                        "id": 6397082627213028
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "q": "top(sum:es.query_destinations.count{$env,user_type:career_services,es_cluster:default,$region} by {index}.as_count(), 50, 'sum', 'desc')",
                                    "style": {
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "title": "Uni to Legacy Cluster",
                            "type": "toplist"
                        },
                        "id": 2045295706731634
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "q": "autosmooth(sum:es.query_destinations.count{env:production,user_type:career_services,es_cluster:universities,$region}.as_count()/(sum:es.query_destinations.count{env:production,user_type:career_services,es_cluster:universities,$region}.as_count()+sum:es.query_destinations.count{env:production,user_type:career_services,es_cluster:default,$region}.as_count()))",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                },
                                {
                                    "display_type": "line",
                                    "q": "week_before(autosmooth(sum:es.query_destinations.count{env:production,user_type:career_services,es_cluster:universities,$region}.as_count()/(sum:es.query_destinations.count{env:production,user_type:career_services,es_cluster:universities,$region}.as_count()+sum:es.query_destinations.count{env:production,user_type:career_services,es_cluster:default,$region}.as_count())))",
                                    "style": {
                                        "line_type": "dotted",
                                        "line_width": "normal",
                                        "palette": "gray"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Universities Cluster Percentage",
                            "type": "timeseries"
                        },
                        "id": 6954151976176362
                    }
                ]
            },
            "id": 4154298829314130
        },
        {
            "definition": {
                "layout_type": "ordered",
                "title": "Employer users",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,user_type:employers,es_cluster:employers,$region} by {index}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Employer to Employer Cluster",
                            "type": "timeseries"
                        },
                        "id": 6180604827480492
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.scroll_destinations.count{$env,user_type:employers,es_cluster:employers,$region} by {index}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Employer to Employer Cluster - Scroll",
                            "type": "timeseries"
                        },
                        "id": 5382531593296676
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,user_type:employers,es_cluster:default,$region} by {index}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Employer to Legacy Cluster",
                            "type": "timeseries"
                        },
                        "id": 1140676018061332
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.scroll_destinations.count{$env,user_type:employers,es_cluster:default,$region} by {index}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Employer to Legacy Cluster - Scroll",
                            "type": "timeseries"
                        },
                        "id": 2475683975660906
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "q": "top(sum:es.query_destinations.count{$env,user_type:employers,es_cluster:default,$region} by {index}.as_count(), 50, 'sum', 'desc')",
                                    "style": {
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "title": "Employer to Legacy Cluster",
                            "type": "toplist"
                        },
                        "id": 2962890444506596
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "q": "autosmooth(sum:es.query_destinations.count{env:production,user_type:employers,es_cluster:employers,$region}.as_count()/(sum:es.query_destinations.count{env:production,user_type:employers,es_cluster:employers,$region}.as_count()+sum:es.query_destinations.count{env:production,user_type:employers,es_cluster:default,$region}.as_count()))",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                },
                                {
                                    "display_type": "line",
                                    "q": "week_before(autosmooth(sum:es.query_destinations.count{env:production,user_type:employers,es_cluster:employers,$region}.as_count()/(sum:es.query_destinations.count{env:production,user_type:employers,es_cluster:employers,$region}.as_count()+sum:es.query_destinations.count{env:production,user_type:employers,es_cluster:default,$region}.as_count())))",
                                    "style": {
                                        "line_type": "dotted",
                                        "line_width": "normal",
                                        "palette": "gray"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Employers Cluster Percentage",
                            "type": "timeseries"
                        },
                        "id": 3605728198349956
                    }
                ]
            },
            "id": 1735154857226028
        },
        {
            "definition": {
                "layout_type": "ordered",
                "title": "Admin and Unauthenticated Queries",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "requests": [
                                {
                                    "q": "top(sum:es.query_destinations.count{$env,es_cluster:default,$region,user_type:admins} by {index}.as_count(), 50, 'sum', 'desc')"
                                }
                            ],
                            "title": "Admin to Legacy Cluster",
                            "type": "toplist"
                        },
                        "id": 474664899219956
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,user_type:admins,$region} by {index,es_cluster}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Admin to Any Cluster",
                            "type": "timeseries"
                        },
                        "id": 3399245176512188
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.scroll_destinations.count{$env,user_type:admins,$region} by {index,es_cluster}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Admin to Any Cluster - Scroll",
                            "type": "timeseries"
                        },
                        "id": 2178255410688758
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,user_type:unauthenticated,$region} by {index,es_cluster}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Unauthenticated to Any Cluster",
                            "type": "timeseries"
                        },
                        "id": 5228850017340368
                    },
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.scroll_destinations.count{$env,user_type:unauthenticated,$region} by {index,es_cluster}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Unauthenticated to Any Cluster - Scroll",
                            "type": "timeseries"
                        },
                        "id": 6057946808010630
                    }
                ]
            },
            "id": 2002742031841032
        },
        {
            "definition": {
                "layout_type": "ordered",
                "title": "Mentor users",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "legend_size": "0",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "q": "sum:es.query_destinations.count{$env,user_type:mentors,es_cluster:default,$region} by {index}.as_count()",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Mentors to Legacy Cluster",
                            "type": "timeseries"
                        },
                        "id": 5814001579286560
                    }
                ]
            },
            "id": 6762104387128838
        }
    ]
}